#!/usr/bin/env python

import os
import sys

from satorlib.config import SatorConfig
from satorlib.local import *
from satorlib.remote import *

def usage():
    print "sator reverse SSH manager...\n"

    print "Set your configuration in ~/.sator/satorrc\n"

    print "Run without options to set up a stubbed configuration file.\n"

    print "sator can be run in the following modes:"
    print "   sator local - Run this mode on the machine (or machines) behind the"
    print "                 NAT or firewalls which are restricting your access to"
    print "                 them.\n"

    print "  sator remote - The remote mode should not be ran manually. It will"
    print "                 be ran by the sator script on the remote machine(s).\n"

if __name__ == "__main__":
    # We must be run from the command line
    argv = sys.argv[1:]
    root = "%s/.sator" % (os.path.expanduser("~"))
    config = SatorConfig(root)
    if "local" in argv:
        local(config, argv)
    elif "remote" in argv:
        remote(config, argv)
    else:
        usage()
